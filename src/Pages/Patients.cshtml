@page
@model PatientsModel
@{
    ViewData["Title"] = "Patients";
}

<style>
    .patients-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }

    .patients-title {
        color: #2c3e50;
        text-align: center;
        margin-bottom: 30px;
        font-size: 2.5rem;
        font-weight: bold;
    }

    .patients-table {
        width: 100%;
        border-collapse: collapse;
        box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        background-color: white;
        border-radius: 8px;
        overflow: hidden;
    }

    .patients-table thead {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

    .patients-table th {
        padding: 15px;
        text-align: left;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.9rem;
        letter-spacing: 0.5px;
    }

    .patients-table tbody tr {
        border-bottom: 1px solid #ecf0f1;
        transition: all 0.3s ease;
        cursor: pointer;
    }

    .patients-table tbody tr:hover {
        background-color: #f8f9fa;
        transform: scale(1.01);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .patients-table tbody tr:nth-child(even) {
        background-color: #f8f9fa;
    }

    .patients-table td {
        padding: 15px;
        color: #2c3e50;
    }

    .patient-name {
        color: #667eea;
        font-weight: 600;
        text-decoration: none;
    }

    .patient-name:hover {
        text-decoration: underline;
    }

    .gender-badge {
        display: inline-block;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 500;
    }

    .gender-male {
        background-color: #e3f2fd;
        color: #1976d2;
    }

    .gender-female {
        background-color: #fce4ec;
        color: #c2185b;
    }

    .patient-photo {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid #667eea;
    }
</style>

<div class="patients-container">
    <h1 class="patients-title">@ViewData["Title"]</h1>
    
    @if (Model.Patients != null && Model.Patients.Any())
    {
        <table class="patients-table">
            <thead>
                <tr>
                    <th>Photo</th>
                    <th>Patient ID</th>
                    <th>Name</th>
                    <th>Date of Birth</th>
                    <th>Gender</th>
                    <th>Phone</th>
                    <th>Blood Type</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var patient in Model.Patients)
                {
                    <tr onclick="showPatientDetails(@patient.Id)">
                        <td>
                            <img src="@patient.PhotoUrl" alt="@patient.FirstName @patient.LastName" class="patient-photo" />
                        </td>
                        <td>@patient.Id.ToString("D5")</td>
                        <td>
                            <span class="patient-name">@patient.FirstName @patient.LastName</span>
                        </td>
                        <td>@patient.DateOfBirth.ToString("MMM dd, yyyy")</td>
                        <td>
                            <span class="gender-badge gender-@patient.Gender.ToLower()">@patient.Gender</span>
                        </td>
                        <td>@patient.PhoneNumber</td>
                        <td>@patient.BloodType</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p class="text-center">No patient data available.</p>
    }
</div>

<script>
    function showPatientDetails(patientId) {
        // Open patient details in a new popup window
        const width = 850;
        const height = 700;
        const left = (screen.width - width) / 2;
        const top = (screen.height - height) / 2;
        
        const features = `width=${width},height=${height},left=${left},top=${top},resizable=yes,scrollbars=yes,status=yes`;
        const popup = window.open(`/PatientDetail/${patientId}`, `patient_${patientId}`, features);
        
        if (popup) {
            popup.focus();
        } else {
            alert('Please allow popups for this website to view patient details.');
        }
    }
</script>
